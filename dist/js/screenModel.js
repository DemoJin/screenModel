if(void 0===screenModel||!screenModel)var screenModel={};!function(){screenModel=function(a){this.options={parent:$("#id"),linkId:"",urlStart:"",url:"",childUrl:"",sureUrl:"",source:"",async:!0},$.extend(this.options,a),this.options.parent=$(a.parent),this.options.parentStr=a.parent,this._init(),this.sureCard(),this.hideCard()},screenModel.prototype={_init:function(){var a=this,e=a.options.parent,n={esf_datas:[{datas:[{value:"-",name:"朝向不限",active:1},{value:"东",name:"东"},{value:"南",name:"南"},{value:"西",name:"西"},{value:"北",name:"北"},{value:"南北",name:"南北"},{value:"东西",name:"东西"},{value:"东南",name:"东南"},{value:"西南",name:"西南"},{value:"东北",name:"东北"},{value:"西北",name:"西北"}]},{datas:[{value:"-",name:"装修不限",active:1},{value:"毛坯",name:"毛坯"},{value:"简单装修",name:"简单装修"},{value:"中等装修",name:"中等装修"},{value:"精装修",name:"精装修"},{value:"豪华装修",name:"豪华装修"}]},{datas:[{value:"-",name:"房龄不限",active:1},{value:"2年以下",name:"2年以下"},{value:"2-5年",name:"2-5年"},{value:"5-10年",name:"5-10年"},{value:"10年以上",name:"10年以上"}]},{datas:[{value:"-",name:"楼层不限",active:1},{value:"地下",name:"地下"},{value:"1层",name:"1层"},{value:"6层以下",name:"6层以下"},{value:"6-12层",name:"6-12层"},{value:"12层以上",name:"12层以上"}]},{datas:[{value:"-",name:"来源不限",active:1},{value:"个人",name:"个人"},{value:"经纪人",name:"经纪人"}]},{datas:[{value:"-",name:"产权类型",active:1},{value:"商品房",name:"商品房"},{value:"商住两用",name:"商住两用"},{value:"经济适用房",name:"经济适用房"},{value:"使用权",name:"使用权"},{value:"公房",name:"公房"},{value:"其他",name:"其他"}]},{datas:[{value:"-",name:"类型不限",active:1},{value:"普通住宅",name:"普通住宅"},{value:"公寓",name:"公寓"},{value:"别墅",name:"别墅"},{value:"平房",name:"平房"},{value:"新里洋房",name:"新里洋房"},{value:"老公房",name:"老公房"},{value:"四合院",name:"四合院"},{value:"排屋",name:"排屋"},{value:"其他",name:"其他"}]}],cz_datas:[{datas:[{value:"-",name:"朝向不限",active:1},{value:"东",name:"东"},{value:"南",name:"南"},{value:"西",name:"西"},{value:"北",name:"北"},{value:"南北",name:"南北"},{value:"东西",name:"东西"},{value:"东南",name:"东南"},{value:"西南",name:"西南"},{value:"东北",name:"东北"},{value:"西北",name:"西北"}]},{datas:[{value:"-",name:"装修不限",active:1},{value:"毛坯",name:"毛坯"},{value:"简单装修",name:"简单装修"},{value:"中等装修",name:"中等装修"},{value:"精装修",name:"精装修"},{value:"豪华装修",name:"豪华装修"}]}]};a.sendAjax(a.options.url,function(){return{linkId:a.options.linkId}},function(){e.find(".card_ergodic").append('<div class="loading"></div>')},function(t){e.find(".loading").remove();var l=t.data,r=t.source;a.options.source=r,"ershoufang"==r?a.forSel(n.esf_datas):a.forSel(n.cz_datas),a.getData(l,r),a.clickCurrent()})},forSel:function(a){var e=this,n=e.options.parent;e.Console(JSON.stringify(a),a.length,"------");for(var t="",l=0;l<a.length;l++){var r="",i=a[l];e.Console(i.datas.length);for(var o=0;o<i.datas.length;o++){var s=i.datas[o].active,c=i.datas[o].value,u=i.datas[o].name;r+='<option value="'+c+'"'+(s?"selected":"")+">"+u+"</option>"}t+="<li><select>"+r+"</select></li>"}var d='<div class="screen"><ul class="card_ergodic"></ul><div class="card_regular"><label for="keyWord">关键词<input id="keyWord" type="text" placeholder="请输入关键词"></label><ul>'+t+'</ul></div><div class="card_btn"><button class="sure_btn">确定</button><button class="cancle_btn">取消</button></div>';n.fadeIn(100).append(d)},sendAjax:function(a,e,n,t){var l=this,r=l.options.parent;$.ajax({url:l.options.urlStart+a,data:e(),type:"POST",cache:!1,async:l.options.async,beforeSend:n,success:t,error:function(){l.Console("数据加载有误！"),l.hideCard()},complete:function(){r.find(".loading").remove(),$(".demo li").removeClass("disabled")}})},renderHtml:function(a){for(var e="",n=0;n<a.datas.length;n++){var t=a.datas[n].value,l=a.datas[n].name;e+='<span data-value="'+t+'"'+(a.datas[n].active?'class="active"':"")+">"+l+"</span>"}return e},childRegionHtml:function(a){for(var e="",n=0;n<a.length;n++){for(var t="",l=a[n],r=0;r<l.text.length;r++){var i=l.text[r].value,o=l.text[r].name;t+='<span data-value="'+i+'"'+(l.text[r].active?'class="active"':"")+">"+o+"</span>"}e+="<em>"+l.name+"</em>"+t}return e},getData:function(a,e){var n="",t=this;for(var l in a){var r=a[l];n+="[object Array]"==Object.prototype.toString.call(r)?'<li class="'+l+'">'+t.childRegionHtml(r)+"</li>":'<li class="'+l+'"><label>'+r.name+"</label>"+t.renderHtml(r)+"</li>"}t.options.parent.addClass(e).find(".card_ergodic").append(n)},clickCurrent:function(){var a=this;a.options.parent;$(".card_ergodic").unbind().on("click","li span",function(){$(this).addClass("active").siblings().removeClass("active"),a.Console($(this).attr("data-value")),"region"!=$(this).parent().attr("class")&&"childRegion"!=$(this).parent().attr("class")&&"way"!=$(this).parent().attr("class")||a.sendAjax(a.options.childUrl,function(){return a.requestData.linkId=a.options.linkId,a.requestData()},function(){$(".card_ergodic").empty()},function(e){var n=e.data,t=e.source;a.getData(n,t)})})},requestData:function(){var a=this,e=(a.options.parent,"");$(".card_regular li").each(function(){e+=$(this).find("select").attr("value")+","});var n={source:a.options.source,linkId:a.options.linkId,region:$(".region .active").attr("data-value"),childRegion:$(".childRegion .active").attr("data-value"),keyWord:$("#keyWord").val(),option:e.slice(0,-1)};return"ershoufang"==a.options.source?(n.total=$(".total .active").attr("data-value"),n.area=$(".area .active").attr("data-value"),n.brand=$(".brand .active").attr("data-value")):(n.rent=$(".rent .active").attr("data-value"),n.room=$(".room .active").attr("data-value"),n.way=$(".way .active").attr("data-value")),n},sureCard:function(){var a=this;a.options.parent;$(".screenModel").unbind().on("click",".sure_btn",function(e){e.stopPropagation(),a.sendAjax(a.options.sureUrl,function(){return a.requestData()},function(){a.Console(a.requestData())},function(e){a.cancleCard()})})},cancleCard:function(){$(".screenModel").fadeOut(100).find(".screen").remove()},hideCard:function(){var a=this;$(".screenModel").on("click",".cancle_btn,.screenBg",function(e){e.stopPropagation(),a.cancleCard()})},resizeOuterIframe:function(){var a=$("#myframe",window.parent.document),e=$("#sidebar",window.parent.document);if(0==a.length){var n=$(".tabs-header .tabs .tabs-selected",window.parent.document).attr("data-flag");a=$('.tabs-panels iframe[data-flag="'+n+'"]',window.parent.document)}var t=parseInt(a.contents().find(".r_content").css("height"));a.css({height:t+60}),e.css({height:t+105})},cardSelect:function(){$(".card_regular select").on("click",function(){var a=$(this).find("option:selected").text();$(this).prev("span").html(a).css("color","#333")})},Console:function(a){if(1==localStorage.isdebug)return console.log(a)}}}();